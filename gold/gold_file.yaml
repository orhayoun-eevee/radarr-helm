---
# Source: radarr/templates/all.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: radarr-default
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "network-policy"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  policyTypes:
    - Ingress
    - Egress
  ingress:
    - from:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: istio-system
        podSelector:
          matchLabels:
            app.kubernetes.io/name: shared-platform-gateway
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: monitoring
        podSelector:
          matchLabels:
            app.kubernetes.io/name: prometheus
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: homeassistant
        podSelector:
          matchLabels:
            app.kubernetes.io/name: home-assistant
      ports:
      - port: 15008
        protocol: TCP
  egress:
    - ports:
      - port: 53
        protocol: UDP
      - port: 53
        protocol: TCP
      to:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: kube-system
        podSelector:
          matchLabels:
            k8s-app: kube-dns
    - ports:
      - port: 5432
        protocol: TCP
      to:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: postgresql
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: databases
    - ports:
      - port: 15008
        protocol: TCP
      to:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: istio-system
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: download-clients
    - ports:
      - port: 443
        protocol: TCP
      to:
      - ipBlock:
          cidr: 0.0.0.0/0
          except:
          - 10.42.0.0/16
          - 10.43.0.0/16
          - 192.168.0.0/16
---
# Source: radarr/templates/all.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: radarr
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "serviceaccount"
  annotations:
    app.kubernetes.io/managed-by: argocd
    description: Radarr media center service account
automountServiceAccountToken: false
---
# Source: radarr/templates/all.yaml
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: radarr-config
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "pvc"
  annotations:
    helm.sh/resource-policy: keep
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: longhorn
  resources:
    requests:
      storage: 1Gi
---
# Source: radarr/templates/all.yaml
apiVersion: v1
kind: Service
metadata:
  name: radarr-http
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: service-http
  annotations:
    description: Radarr media center HTTP service
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 8080
      targetPort: http
      protocol: TCP
  selector:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
---
# Source: radarr/templates/all.yaml
apiVersion: v1
kind: Service
metadata:
  name: radarr-metrics
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: service-metrics
  annotations:
    description: Radarr media center HTTP service
spec:
  type: ClusterIP
  ports:
    - name: metrics
      port: 9100
      targetPort: metrics
      protocol: TCP
  selector:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
---
# Source: radarr/templates/all.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: radarr
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "deployment"
spec:
  replicas: 1
  revisionHistoryLimit: 3
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  template:
    metadata:
      labels:
        app.kubernetes.io/instance: radarr
        app.kubernetes.io/name: radarr
        app.kubernetes.io/version: 6.0.4.10291
        helm.sh/chart: radarr-0.0.3
        app.kubernetes.io/component: media-manager
        app.kubernetes.io/part-of: media-center
        logging.kubernetes.io/component: media-center
        logging.kubernetes.io/service: radarr
    spec:
      terminationGracePeriodSeconds: 60
      securityContext:
        fsGroup: 1011
        fsGroupChangePolicy: OnRootMismatch
        runAsNonRoot: true
        supplementalGroups:
        - 1010
        - 1003
      serviceAccountName: radarr
      dnsPolicy: ClusterFirst
      automountServiceAccountToken: false
      enableServiceLinks: false
      containers:
        - name: exportarr
          image: ghcr.io/orhayoun/exportarr:v2.3.1@sha256:2650f6a501b1d691daf5dfe758068f44336d0bb1d443f9db2c94900244d423bc
          imagePullPolicy: Always
          ports:
            - name: metrics
              containerPort: 9100
              protocol: TCP
          args:
            - radarr
          env:
            - name: URL
              value: http://localhost:8080
            - name: CONFIG
              value: /config/config.xml
            - name: PORT
              value: "9100"
            - name: ENABLE_ADDITIONAL_METRICS
              value: "false"
            - name: ENABLE_UNKNOWN_QUEUE_ITEMS
              value: "false"
          volumeMounts:
            - mountPath: /config
              name: config
          resources:
            limits:
              cpu: 100m
              ephemeral-storage: 10Mi
              memory: 64Mi
            requests:
              cpu: 10m
              ephemeral-storage: 10Mi
              memory: 32Mi
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /metrics
              port: metrics
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 5
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /metrics
              port: metrics
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
          startupProbe:
            failureThreshold: 30
            httpGet:
              path: /metrics
              port: metrics
              scheme: HTTP
            initialDelaySeconds: 45
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 10
          securityContext:
            allowPrivilegeEscalation: false
            appArmorProfile:
              type: RuntimeDefault
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: true
            runAsGroup: 65534
            runAsNonRoot: true
            runAsUser: 65534
            seccompProfile:
              type: RuntimeDefault
        - name: radarr
          image: ghcr.io/runlix/radarr:release-6.0.4.10291-latest@sha256:9a66eb0d9422af321be8435183613bc23f8f047c1a9e2b4f51e75ea2ebfab32e
          imagePullPolicy: Always
          ports:
            - name: http
              containerPort: 8080
              protocol: TCP
          env:
            - name: TZ
              value: UTC
            - name: RADARR__SERVER__PORT
              value: "8080"
            - name: RADARR__SERVER__BINDADDRESS
              value: 0.0.0.0
          volumeMounts:
            - mountPath: /config
              name: config
            - mountPath: /media
              name: media
            - mountPath: /media-old
              name: media-old
            - mountPath: /downloads
              name: downloads
            - mountPath: /backup
              name: backup
            - mountPath: /tmp
              name: tmp
          resources:
            limits:
              cpu: 500m
              ephemeral-storage: 2Gi
              memory: 1Gi
            requests:
              cpu: 500m
              ephemeral-storage: 2Gi
              memory: 256Mi
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /ping
              port: http
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 5
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /ping
              port: http
              scheme: HTTP
            initialDelaySeconds: 15
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
          startupProbe:
            failureThreshold: 30
            httpGet:
              path: /ping
              port: http
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 5
          securityContext:
            allowPrivilegeEscalation: false
            appArmorProfile:
              type: RuntimeDefault
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1011
            runAsNonRoot: true
            runAsUser: 1013
            seccompProfile:
              type: RuntimeDefault
      volumes:
        -
          name: config
          persistentVolumeClaim:
            claimName: radarr-config
        -
          name: media
          nfs:
            path: /mnt/vol1/media-center/media/movies
            server: snorlax.orhayoun.com
        -
          name: media-old
          nfs:
            path: /mnt/vol1/Media/videos/Movies
            server: snorlax.orhayoun.com
        -
          name: downloads
          nfs:
            path: /mnt/vol1/media-center/downloads
            server: snorlax.orhayoun.com
        -
          name: backup
          nfs:
            path: /mnt/vol1/media-center/backup/radarr
            server: snorlax.orhayoun.com
        -
          emptyDir:
            sizeLimit: 1Gi
          name: tmp
---
# Source: radarr/templates/all.yaml
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: radarr-homeassistant
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "authorization-policy"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  selector:
    matchLabels:
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  action: ALLOW
  rules:
    - from:
      - source:
          principals:
          - cluster.local/ns/homeassistant/sa/homeassistant-home-assistant
      to:
      - operation:
          ports:
          - "8080"
---
# Source: radarr/templates/all.yaml
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: radarr-ingress
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "authorization-policy"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  selector:
    matchLabels:
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  action: ALLOW
  rules:
    - from:
      - source:
          principals:
          - cluster.local/ns/istio-system/sa/shared-platform-gateway-istio
      to:
      - operation:
          ports:
          - "8080"
---
# Source: radarr/templates/all.yaml
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: radarr-prometheus
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "authorization-policy"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  selector:
    matchLabels:
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  action: ALLOW
  rules:
    - from:
      - source:
          principals:
          - cluster.local/ns/monitoring/sa/prometheus-kube-prometheus-prometheus
      to:
      - operation:
          ports:
          - "9100"
---
# Source: radarr/templates/all.yaml
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: radarr
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "destination-rule"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  host: radarr-http
  trafficPolicy:
    connectionPool:
      http:
        http1MaxPendingRequests: 10
        http2MaxRequests: 100
        maxRequestsPerConnection: 2
      tcp:
        maxConnections: 100
    outlierDetection:
      baseEjectionTime: 30s
      consecutive5xxErrors: 5
      interval: 30s
      maxEjectionPercent: 50
---
# Source: radarr/templates/all.yaml
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: radarr-radarr-dashboard
  namespace: media-center
  labels:
    app.kubernetes.io/component: grafana-dashboard
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
spec:
  json: |
    {"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations \u0026 Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":141,"links":[],"liveNow":false,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":1000,"panels":[],"title":"ðŸ“Š Application Metrics","type":"row"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"0":{"color":"red","text":"Unhealthy"},"1":{"color":"green","text":"Healthy"}},"type":"value"}],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":0,"y":1},"id":1,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_system_status{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"System Status","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":10},{"color":"red","value":50}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":6,"y":1},"id":2,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_cutoff_unmet_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"Backlog Size","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"match":"null","result":{"text":"N/A"}},"type":"special"},{"options":{"from":-999999999999,"result":{"color":"green","text":"Draining"},"to":0},"type":"range"},{"options":{"from":0,"result":{"color":"red","text":"Growing"},"to":999999999999},"type":"range"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":0}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":12,"y":1},"id":3,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"delta(radarr_movie_cutoff_unmet_total{service=\"radarr\", component=\"media-center\"}[24h]) * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"Backlog Delta (24h)","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"movies/hour"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":18,"y":1},"id":4,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(increase(radarr_movie_downloaded_total{service=\"radarr\", component=\"media-center\"}[1h])) * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"Import/Download Rate (1h)","type":"stat"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":5},"id":2000,"panels":[],"title":"ðŸ“ˆ Progress \u0026 Capacity","type":"row"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":6},"id":2001,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_missing_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","legendFormat":"Missing Movies","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_cutoff_unmet_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","legendFormat":"Cutoff Unmet","refId":"B"}],"title":"Backlog Over Time","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":6},"id":2002,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_downloaded_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","legendFormat":"Downloaded","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_missing_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","legendFormat":"Missing","refId":"B"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_total{service=\"radarr\", component=\"media-center\"} * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","legendFormat":"Total","refId":"C"}],"title":"Movie Flow Over Time","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":0,"y":14},"id":117,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(increase(radarr_movie_downloaded_total{service=\"radarr\",component=\"media-center\"}[7d]))","refId":"A"}],"title":"Downloaded Movies (7d)","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":6,"y":14},"id":118,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(increase(radarr_movie_downloaded_total{service=\"radarr\",component=\"media-center\"}[30d]))","refId":"A"}],"title":"Downloaded Movies (30d)","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":12,"y":14},"id":119,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"delta(radarr_movie_missing_total{service=\"radarr\", component=\"media-center\"}[24h]) * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"Missing Movies Î” (24h)","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":18,"y":14},"id":120,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"delta(radarr_movie_cutoff_unmet_total{service=\"radarr\", component=\"media-center\"}[24h]) * on(pod) group_left() (kube_pod_status_phase{namespace=\"$namespace\",pod=~\"$pod_regex\",phase=\"Running\"} @ end())","refId":"A"}],"title":"Cutoff Unmet Î” (24h)","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":50},{"color":"red","value":100}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":0,"y":18},"id":113,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_history_total{service=\"radarr\", component=\"media-center\"}","refId":"A"}],"title":"History Items","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":4,"w":6,"x":6,"y":18},"id":28,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"radarr_movie_downloaded_total{service=\"radarr\", component=\"media-center\"}","refId":"A"}],"title":"Downloaded Movies","type":"stat"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":22},"id":3000,"panels":[],"title":"ðŸ’» Resource Usage","type":"row"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":85}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":8,"w":8,"x":0,"y":23},"id":3001,"options":{"displayMode":"gradient","minVizHeight":10,"minVizWidth":0,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"sizing":"auto","text":{}},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", container=\"radarr\"}[5m])) / sum(kube_pod_container_resource_limits{resource=\"cpu\", namespace=\"$namespace\", container=\"radarr\"}) * 100","refId":"A"}],"title":"CPU Usage","type":"gauge"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":85}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":8,"w":8,"x":8,"y":23},"id":3002,"options":{"displayMode":"gradient","minVizHeight":10,"minVizWidth":0,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true,"sizing":"auto","text":{}},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(container_memory_working_set_bytes{namespace=\"$namespace\", container=\"radarr\"}) / sum(kube_pod_container_resource_limits{resource=\"memory\", namespace=\"$namespace\", container=\"radarr\"}) * 100","refId":"A"}],"title":"Memory Usage","type":"gauge"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":0.1},{"color":"red","value":0.5}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":8,"x":16,"y":23},"id":3003,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_cpu_cfs_throttled_seconds_total{namespace=\"$namespace\", container=\"radarr\"}[5m]))","refId":"A"}],"title":"CPU Throttling Rate","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":31},"id":3004,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"$namespace\", container=\"radarr\"}[5m])) / sum(kube_pod_container_resource_limits{resource=\"cpu\", namespace=\"$namespace\", container=\"radarr\"}) * 100","legendFormat":"CPU Usage %","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"max((kube_pod_container_resource_requests{resource=\"cpu\", namespace=\"$namespace\", container=\"radarr\"} / kube_pod_container_resource_limits{resource=\"cpu\", namespace=\"$namespace\", container=\"radarr\"}) * 100) by (namespace, container)","legendFormat":"CPU Request","refId":"B"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"100","legendFormat":"CPU Limit","refId":"C"}],"title":"CPU Usage Over Time","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":31},"id":3005,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(container_memory_working_set_bytes{namespace=\"$namespace\", container=\"radarr\"})","legendFormat":"Memory Used","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(kube_pod_container_resource_limits{resource=\"memory\", namespace=\"$namespace\", container=\"radarr\"})","legendFormat":"Memory Limit","refId":"B"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(kube_pod_container_resource_requests{resource=\"memory\", namespace=\"$namespace\", container=\"radarr\"})","legendFormat":"Memory Request","refId":"C"}],"title":"Memory Usage Over Time","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":80}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":4,"w":8,"x":0,"y":39},"id":3006,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"editorMode":"code","exemplar":false,"expr":"(kubelet_volume_stats_available_bytes{namespace=\"$namespace\", persistentvolumeclaim=~\".*radarr.*\"} / kubelet_volume_stats_capacity_bytes{namespace=\"$namespace\", persistentvolumeclaim=~\".*radarr.*\"}) * 100","interval":"","legendFormat":"__auto","range":true,"refId":"A"}],"title":"PVC Available %","type":"stat"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":80}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":4,"w":8,"x":8,"y":39},"id":3007,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"(kubelet_volume_stats_inodes_used{namespace=\"$namespace\", persistentvolumeclaim=~\".*radarr.*\"} / kubelet_volume_stats_inodes{namespace=\"$namespace\", persistentvolumeclaim=~\".*radarr.*\"}) * 100","refId":"A"}],"title":"PVC Inode Usage %","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"description":"Alerts: SabnzbdPVCHighUsage","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":80}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":4,"w":8,"x":16,"y":39},"id":3012,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"editorMode":"code","expr":"(kubelet_volume_stats_used_bytes{persistentvolumeclaim=\"radarr-config\", namespace=\"$namespace\"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim=\"radarr-config\", namespace=\"$namespace\"}) * 100","range":true,"refId":"A"}],"title":"Config PVC Usage","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"Bps"},"overrides":[]},"gridPos":{"h":6,"w":24,"x":0,"y":43},"id":3008,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_fs_reads_bytes_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"Read IO","refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"editorMode":"code","expr":"sum(rate(container_fs_writes_bytes_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","hide":false,"instant":false,"legendFormat":"Write IO","range":true,"refId":"B"}],"title":"Filesystem Read / Write IO","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"ms"},"overrides":[]},"gridPos":{"h":6,"w":24,"x":0,"y":49},"id":3009,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"histogram_quantile(0.95, sum(rate(istio_request_duration_milliseconds_bucket{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\"}[5m])) by (le))","legendFormat":"p95 Response Time","refId":"A"}],"title":"Response Time (p95)","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"reqps"},"overrides":[]},"gridPos":{"h":5,"w":6,"x":0,"y":55},"id":3010,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\"}[5m]))","refId":"A"}],"title":"Request Rate","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"reqps"},"overrides":[]},"gridPos":{"h":5,"w":18,"x":6,"y":55},"id":3013,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"editorMode":"code","expr":"sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\"}[5m]))","legendFormat":"Request Rate (req/s)","range":true,"refId":"A"}],"title":"Request Rate Over Time","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":0.1},{"color":"red","value":1}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":5,"w":6,"x":0,"y":60},"id":3011,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","percentChangeColorMode":"standard","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showPercentChange":false,"textMode":"auto","wideLayout":true},"pluginVersion":"11.1.3","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"(sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\", response_code=~\"5..\"}[5m])) / sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\"}[5m]))) * 100","refId":"A"}],"title":"Error Rate (%)","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"percent"},"overrides":[]},"gridPos":{"h":5,"w":18,"x":6,"y":60},"id":3014,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"editorMode":"code","expr":"(sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\", response_code=~\"5..\"}[5m])) / sum(rate(istio_requests_total{destination_service_name=\"radarr\", destination_service_namespace=\"$namespace\"}[5m]))) * 100","legendFormat":"Error Rate (%)","range":true,"refId":"A"}],"title":"Error Rate Over Time","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"Bps"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":65},"id":3015,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_receive_bytes_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"rx","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_transmit_bytes_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"tx","refId":"B"}],"title":"Network Throughput","type":"timeseries"},{"datasource":{"name":"Prometheus","type":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":65},"id":3016,"options":{"legend":{"calcs":["last","max","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.0.0","targets":[{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_receive_errors_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"rx_err","refId":"A"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_transmit_errors_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"tx_err","refId":"B"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_receive_packets_dropped_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"rx_drop","refId":"C"},{"datasource":{"name":"Prometheus","type":"prometheus"},"expr":"sum(rate(container_network_transmit_packets_dropped_total{pod=~\"$pod_regex\", namespace=\"$namespace\"}[5m]))","legendFormat":"tx_drop","refId":"D"}],"title":"Network Errors / Drops","type":"timeseries"}],"refresh":"30s","schemaVersion":39,"tags":["radarr","media-center","monitoring","exportarr","media-center","radarr"],"templating":{"list":[{"hide":2,"name":"namespace","query":"media-center","skipUrlSync":false,"type":"constant"},{"hide":2,"name":"pod_regex","query":"radarr-.*","skipUrlSync":false,"type":"constant"},{"hide":0,"label":"Service","name":"service","query":"radarr","queryValue":"","skipUrlSync":false,"type":"constant"},{"hide":0,"label":"Component","name":"component","query":"media-center","queryValue":"","skipUrlSync":false,"type":"constant"}]},"time":{"from":"now-6h","to":"now"},"timepicker":{},"timezone":"","title":"Radarr Dashboard","uid":"radarr-media-center","version":17,"weekStart":""}
---
# Source: radarr/templates/all.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: radarr-route
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "http-route"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  parentRefs:
    - name: shared-platform-gateway
      namespace: istio-system
      kind: Gateway
      group: gateway.networking.k8s.io
      sectionName: https
  hostnames:
    - radarr-k8s.orhayoun.com
  rules:
    -
      matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - group: ""
          kind: Service
          name: radarr-http
          port: 8080
          weight: 100
---
# Source: radarr/templates/all.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: radarr-http-redirect
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "http-route"
  annotations:
    argocd.argoproj.io/sync-wave: "1"
spec:
  parentRefs:
    - name: shared-platform-gateway
      namespace: istio-system
      kind: Gateway
      group: gateway.networking.k8s.io
      sectionName: http
  hostnames:
    - radarr-k8s.orhayoun.com
  rules:
    -
      matches:
        - path:
            type: PathPrefix
            value: /
      filters:
        - requestRedirect:
            scheme: https
            statusCode: 301
          type: RequestRedirect
---
# Source: radarr/templates/all.yaml
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: radarr
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "prometheus-rule"

spec:
  groups:
    - name: radarr.rules
      rules:
        - alert: RadarrDown
          annotations:
            description: Radarr system status is 0 (unhealthy) for more than 5 minutes.
            summary: Radarr service is down
          expr: radarr_system_status{service="radarr", component="media-center"} == 0
          for: 5m
          labels:
            component: media-center
            service: radarr
            severity: critical
        - alert: RadarrQueueHigh
          annotations:
            description: Radarr has more than 100 wanted movies for more than 30 minutes (download
              backlog).
            summary: Radarr wanted backlog is high
          expr: radarr_movie_wanted_total{service="radarr", component="media-center"} > 100
          for: 30m
          labels:
            component: media-center
            service: radarr
            severity: warning
        - alert: RadarrMissingMoviesHigh
          annotations:
            description: Radarr has more than 50 missing movies. This may indicate indexing
              or download issues.
            summary: Radarr has many missing movies
          expr: radarr_movie_missing_total{service="radarr", component="media-center"} > 50
          for: 1h
          labels:
            component: media-center
            service: radarr
            severity: info
        - alert: RadarrExportarrMetricsUnavailable
          annotations:
            description: Radarr pod is running but Exportarr metrics are missing for more
              than 5 minutes. Check Exportarr container logs in pod {{ $labels.pod }}.
            summary: Radarr Exportarr metrics endpoint unavailable
          expr: kube_deployment_status_replicas_available{deployment="radarr", namespace="media-center"}
            > 0 and absent_over_time(radarr_system_status{service="radarr", component="media-center"}[5m])
          for: 5m
          labels:
            component: media-center
            service: radarr
            severity: warning
            sidecar: exportarr
        - alert: RadarrHealthIssuesPresent
          annotations:
            description: Radarr is reporting one or more health issues for more than 15 minutes
              (count={{ $value }}).
            summary: Radarr reports health issues
          expr: radarr_system_health_issues{service="radarr", component="media-center"} >
            0
          for: 15m
          labels:
            component: media-center
            service: radarr
            severity: warning
        - alert: RadarrExporterScrapeSlow
          annotations:
            description: Radarr Exportarr scrape duration exceeded 2s for more than 10 minutes
              (max={{ $value }}s).
            summary: Radarr exporter scrape is slow
          expr: max_over_time(radarr_scrape_duration_seconds{service="radarr", component="media-center"}[10m])
            > 2
          for: 10m
          labels:
            component: media-center
            service: radarr
            severity: warning
            sidecar: exportarr
        - alert: RadarrExporterNotReady
          annotations:
            description: Exporter container in Radarr pod {{ $labels.pod }} is not ready for
              more than 2 minutes.
            summary: Radarr exporter sidecar is not ready
          expr: |
            kube_deployment_status_replicas_available{deployment="radarr", namespace="media-center"} > 0
            and
            kube_pod_container_status_ready{container="exportarr", pod=~"radarr-.*", namespace="media-center"} == 0
          for: 2m
          labels:
            component: media-center
            service: radarr
            severity: warning
            sidecar: exportarr
        - alert: RadarrExporterRestarting
          annotations:
            description: Exporter sidecar container in Radarr pod {{ $labels.pod }} has restarted
              more than 2 times in the last hour.
            summary: Radarr exporter sidecar restarting frequently
          expr: increase(kube_pod_container_status_restarts_total{namespace="media-center",
            pod=~"radarr-.*", container="exportarr"}[1h]) > 2
          for: 0m
          labels:
            component: media-center
            service: radarr
            severity: warning
            sidecar: exportarr
---
# Source: radarr/templates/all.yaml
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: radarr
  namespace: media-center
  labels:
    app.kubernetes.io/instance: radarr
    app.kubernetes.io/name: radarr
    app.kubernetes.io/version: 6.0.4.10291
    helm.sh/chart: radarr-0.0.3
    app.kubernetes.io/component: "servicemonitor"
  annotations:
    argocd.argoproj.io/sync-wave: "2"
spec:
  selector:
    matchLabels:
      app.kubernetes.io/component: service-metrics
      app.kubernetes.io/instance: radarr
      app.kubernetes.io/name: radarr
  namespaceSelector:
    matchNames:
    - media-center
  endpoints:
    - port: metrics
      interval: 10s
      scrapeTimeout: 5s
      path: /metrics
      honorLabels: true
      relabelings:
        - action: replace
          sourceLabels:
          - __meta_kubernetes_namespace
          targetLabel: namespace
        - action: replace
          sourceLabels:
          - __meta_kubernetes_pod_name
          targetLabel: instance
      metricRelabelings:
        - action: replace
          replacement: radarr
          targetLabel: service
        - action: replace
          replacement: media-center
          targetLabel: component
